{% extends "layout.html" %}

{% block title %}Code Paste{% endblock %}

{% block head %}
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/solarized_dark.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>

<script type="text/javascript">
    // make ctrl+a only select code
    function selectText(el) {
        if (typeof window.getSelection != "undefined" && typeof document.createRange != "undefined") {
            var range = document.createRange();
            range.selectNodeContents(el);
            var sel = window.getSelection();
            sel.removeAllRanges();
            sel.addRange(range);
        } else if (typeof document.selection != "undefined" && typeof document.body.createTextRange != "undefined") {
            var textRange = document.body.createTextRange();
            textRange.moveToElementText(el);
            textRange.select();
        }
    }
    document.onkeypress = function (e) {
        e = e || window.event;
        if (e.ctrlKey && e.charCode == 97) {
            var block = document.getElementById("code");
            if (block) {
                selectText(block);
                e.preventDefault();
            }
        }
    }
    window.onload = function() {
        var blocks = document.getElementsByTagName("code");
        for (var i = blocks.length - 1; i >= 0; i--) {
            hljs.configure({ useBR: true });
            hljs.highlightBlock(blocks[i]);
        }
    }
</script>
<style type="text/css">
    code, .line_number {
        font-family: "Source Code Pro", monospace;
        
        /* 
         * Firefox seems to have a problem with relative sizes 
         * in <pre> so I have to specify this in pixels.
         */
        font-size: 16px;
    }
    #content {
        width: 100%;
    }
    #code {
        margin-left: 2.5em;
        white-space: pre;
    }
    body {
        background-color: #002b36;
        color: #586e75;
    }
    #timestamp {
        right: 0;
    }
    #line_numbers {
        list-style-type: none;
        position: absolute;
        width: 2em;
        padding-top: 8px;
    }
    .line_number {
        display: block;
        margin: 0;
        padding: 0;
        text-align: right;
    }
</style>
{% block head2 %}{% endblock %}
{% endblock %}

{% block content %}
    <ol id="line_numbers">
        {% for line in range(code_text.rstrip().split("\n").__len__()) %}
            <li class="line_number">{{ line + 1 }}</li>
        {% endfor %}
    </ol>
    <pre><code id="code">{% for line in code_text.rstrip().split("\n") %}{{ line }}<br>{% endfor %}</code></pre>
{% endblock %}
